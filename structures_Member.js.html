<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: structures/Member.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: structures/Member.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";

const Base = require("./Base");
const Permission = require("./Permission");
const Permissions = require("../Constants").Permissions;
const User = require("./User");
const VoiceState = require("./VoiceState");

/**
* Represents a server member
* @prop {String} id The ID of the member
* @prop {String} mention A string that mentions the member
* @prop {Guild} guild The guild the member is in
* @prop {Number} joinedAt Timestamp of when the member joined the guild
* @prop {String} status The member's status. Either "online", "idle", "dnd", or "offline"
* @prop {Object?} game The active game the member is playing
* @prop {String} game.name The name of the active game
* @prop {Object} clientStatus The member's per-client status
* @prop {String} clientStatus.web The member's status on web. Either "online", "idle", "dnd", or "offline". Will be "online" for bots
* @prop {String} clientStatus.desktop The member's status on desktop. Either "online", "idle", "dnd", or "offline". Will be "offline" for bots
* @prop {String} clientStatus.mobile The member's status on mobile. Either "online", "idle", "dnd", or "offline". Will be "offline" for bots
* @prop {Object[]} activities The member's current activities
* @prop {Number} game.type The type of the active game (0 is default, 1 is Twitch, 2 is YouTube)
* @prop {String?} game.url The url of the active game
* @prop {VoiceState} voiceState The voice state of the member
* @prop {String?} nick The server nickname of the member
* @prop {String[]} roles An array of role IDs this member is a part of
* @prop {User} user The user object of the member
* @prop {Permission} permission The guild-wide permissions of the member
* @prop {String} defaultAvatar The hash for the default avatar of a user if there is no avatar set
* @prop {Number} createdAt Timestamp of user creation
* @prop {Boolean} bot Whether the user is an OAuth bot or not
* @prop {String} username The username of the user
* @prop {String} discriminator The discriminator of the user
* @prop {String?} avatar The hash of the user's avatar, or null if no avatar
* @prop {String} defaultAvatarURL The URL of the user's default avatar
* @prop {String} avatarURL The URL of the user's avatar which can be either a JPG or GIF
* @prop {String} staticAvatarURL The URL of the user's avatar (always a JPG)
*/
class Member extends Base {
    constructor(data, guild, client) {
        super(data.id);
        if((this.guild = guild)) {
            this.user = guild.shard.client.users.get(data.id);
            if(!this.user &amp;&amp; data.user) {
                this.user = guild.shard.client.users.add(data.user, guild.shard.client);
            }
            if(!this.user) {
                throw new Error("User associated with Member not found: " + data.id);
            }
        } else if(data.user) {
            this.user = new User(data.user, client);
        } else {
            this.user = null;
        }
        this.voiceState = new VoiceState(data);
        this.update(data);
    }

    update(data) {
        this.status = data.status !== undefined ? data.status : this.status || "offline";
        this.game = data.game !== undefined ? data.game : this.game || null;
        this.joinedAt = data.joined_at !== undefined ? Date.parse(data.joined_at) : this.joinedAt;
        this.clientStatus = data.client_status !== undefined ? Object.assign({ web: "offline", desktop: "offline", mobile: "offline" }, data.client_status) : this.clientStatus;
        this.activities = data.activities;

        if(data.mute !== undefined) {
            this.voiceState.update(data);
        }

        this.nick = data.nick !== undefined ? data.nick : this.nick || null;
        if(data.roles !== undefined) {
            this.roles = data.roles;
        }
    }

    get permission() {
        if(this.id === this.guild.ownerID) {
            return new Permission(Permissions.all);
        } else {
            let permissions = this.guild.roles.get(this.guild.id).permissions.allow;
            for(let role of this.roles) {
                role = this.guild.roles.get(role);
                if(!role) {
                    continue;
                }

                const {allow: perm} = role.permissions;
                if(perm &amp; Permissions.administrator) {
                    permissions = Permissions.all;
                    break;
                } else {
                    permissions |= perm;
                }
            }
            return new Permission(permissions);
        }
    }

    get username() {
        return this.user.username;
    }

    get discriminator() {
        return this.user.discriminator;
    }

    get avatar() {
        return this.user.avatar;
    }

    get bot() {
        return this.user.bot;
    }

    get createdAt() {
        return this.user.createdAt;
    }

    get defaultAvatar() {
        return this.user.defaultAvatar;
    }

    get defaultAvatarURL() {
        return this.user.defaultAvatarURL;
    }

    get staticAvatarURL(){
        return this.user.staticAvatarURL;
    }

    get avatarURL() {
        return this.user.avatarURL;
    }

    get mention() {
        return `&lt;@!${this.id}>`;
    }

    /**
    * Edit the guild member
    * @arg {Object} options The properties to edit
    * @arg {String[]} [options.roles] The array of role IDs the user should have
    * @arg {String} [options.nick] Set the user's server nickname, "" to remove
    * @arg {Boolean} [options.mute] Server mute the user
    * @arg {Boolean} [options.deaf] Server deafen the user
    * @arg {String} [options.channelID] The ID of the voice channel to move the user to (must be in voice)
    * @arg {String} [reason] The reason to be displayed in audit logs
    * @returns {Promise}
    */
    edit(options, reason) {
        return this.guild.shard.client.editGuildMember.call(this.guild.shard.client, this.guild.id, this.id, options, reason);
    }

    /**
    * Add a role to the guild member
    * @arg {String} roleID The ID of the role
    * @arg {String} [reason] The reason to be displayed in audit logs
    * @returns {Promise}
    */
    addRole(roleID, reason) {
        return this.guild.shard.client.addGuildMemberRole.call(this.guild.shard.client, this.guild.id, this.id, roleID, reason);
    }

    /**
    * Remve a role from the guild member
    * @arg {String} roleID The ID of the role
    * @arg {String} [reason] The reason to be displayed in audit logs
    * @returns {Promise}
    */
    removeRole(roleID, reason) {
        return this.guild.shard.client.removeGuildMemberRole.call(this.guild.shard.client, this.guild.id, this.id, roleID, reason);
    }

    /**
    * Kick the member from the guild
    * @arg {String} [reason] The reason to be displayed in audit logs
    * @returns {Promise}
    */
    kick(reason) {
        return this.guild.shard.client.kickGuildMember.call(this.guild.shard.client, this.guild.id, this.id, reason);
    }

    /**
    * Ban the user from the guild
    * @arg {Number} [deleteMessageDays=0] Number of days to delete messages for
    * @arg {String} [reason] The reason to be displayed in audit logs
    * @returns {Promise}
    */
    ban(deleteMessageDays, reason) {
        return this.guild.shard.client.banGuildMember.call(this.guild.shard.client, this.guild.id, this.id, deleteMessageDays, reason);
    }

    /**
    * Unban the user from the guild
    * @arg {String} [reason] The reason to be displayed in audit logs
    * @returns {Promise}
    */
    unban(reason) {
        return this.guild.shard.client.unbanGuildMember.call(this.guild.shard.client, this.guild.id, this.id, reason);
    }

    toJSON() {
        const base = super.toJSON(true);
        for(const prop of ["game", "joinedAt", "nick", "roles", "status", "user", "voiceState"]) {
            if(this[prop] !== undefined) {
                base[prop] = this[prop] &amp;&amp; this[prop].toJSON ? this[prop].toJSON() : this[prop];
            }
        }
        return base;
    }
}

module.exports = Member;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Bucket.html">Bucket</a></li><li><a href="Call.html">Call</a></li><li><a href="CategoryChannel.html">CategoryChannel</a></li><li><a href="Channel.html">Channel</a></li><li><a href="Client.html">Client</a></li><li><a href="Collection.html">Collection</a></li><li><a href="Command.html">Command</a></li><li><a href="CommandClient.html">CommandClient</a></li><li><a href="ExtendedUser.html">ExtendedUser</a></li><li><a href="GroupChannel.html">GroupChannel</a></li><li><a href="Guild.html">Guild</a></li><li><a href="GuildAuditLogEntry.html">GuildAuditLogEntry</a></li><li><a href="GuildChannel.html">GuildChannel</a></li><li><a href="GuildIntegration.html">GuildIntegration</a></li><li><a href="Invite.html">Invite</a></li><li><a href="Member.html">Member</a></li><li><a href="Message.html">Message</a></li><li><a href="Permission.html">Permission</a></li><li><a href="PermissionOverwrite.html">PermissionOverwrite</a></li><li><a href="PrivateChannel.html">PrivateChannel</a></li><li><a href="Relationship.html">Relationship</a></li><li><a href="RequestHandler.html">RequestHandler</a></li><li><a href="Role.html">Role</a></li><li><a href="SequentialBucket.html">SequentialBucket</a></li><li><a href="Shard.html">Shard</a></li><li><a href="SharedStream.html">SharedStream</a></li><li><a href="TextChannel.html">TextChannel</a></li><li><a href="UnavailableGuild.html">UnavailableGuild</a></li><li><a href="User.html">User</a></li><li><a href="VoiceChannel.html">VoiceChannel</a></li><li><a href="VoiceConnection.html">VoiceConnection</a></li><li><a href="VoiceDataStream.html">VoiceDataStream</a></li><li><a href="VoiceState.html">VoiceState</a></li></ul><h3>Events</h3><ul><li><a href="Client.html#event:callCreate">callCreate</a></li><li><a href="Client.html#event:callDelete">callDelete</a></li><li><a href="Client.html#event:callRing">callRing</a></li><li><a href="Client.html#event:callUpdate">callUpdate</a></li><li><a href="Client.html#event:channelCreate">channelCreate</a></li><li><a href="Client.html#event:channelDelete">channelDelete</a></li><li><a href="Client.html#event:channelPinUpdate">channelPinUpdate</a></li><li><a href="Client.html#event:channelRecipientAdd">channelRecipientAdd</a></li><li><a href="Client.html#event:channelRecipientRemove">channelRecipientRemove</a></li><li><a href="Client.html#event:channelUpdate">channelUpdate</a></li><li><a href="Client.html#event:connect">connect</a></li><li><a href="Client.html#event:debug">debug</a></li><li><a href="Client.html#event:disconnect">disconnect</a></li><li><a href="Client.html#event:error">error</a></li><li><a href="Client.html#event:friendSuggestionCreate">friendSuggestionCreate</a></li><li><a href="Client.html#event:friendSuggestionDelete">friendSuggestionDelete</a></li><li><a href="Client.html#event:guildAvailable">guildAvailable</a></li><li><a href="Client.html#event:guildBanAdd">guildBanAdd</a></li><li><a href="Client.html#event:guildBanRemove">guildBanRemove</a></li><li><a href="Client.html#event:guildCreate">guildCreate</a></li><li><a href="Client.html#event:guildDelete">guildDelete</a></li><li><a href="Client.html#event:guildEmojisUpdate">guildEmojisUpdate</a></li><li><a href="Client.html#event:guildMemberAdd">guildMemberAdd</a></li><li><a href="Client.html#event:guildMemberChunk">guildMemberChunk</a></li><li><a href="Client.html#event:guildMemberRemove">guildMemberRemove</a></li><li><a href="Client.html#event:guildMemberUpdate">guildMemberUpdate</a></li><li><a href="Client.html#event:guildRoleCreate">guildRoleCreate</a></li><li><a href="Client.html#event:guildRoleDelete">guildRoleDelete</a></li><li><a href="Client.html#event:guildRoleUpdate">guildRoleUpdate</a></li><li><a href="Client.html#event:guildUnavailable">guildUnavailable</a></li><li><a href="Client.html#event:guildUpdate">guildUpdate</a></li><li><a href="Client.html#event:hello">hello</a></li><li><a href="Client.html#event:messageCreate">messageCreate</a></li><li><a href="Client.html#event:messageDelete">messageDelete</a></li><li><a href="Client.html#event:messageDeleteBulk">messageDeleteBulk</a></li><li><a href="Client.html#event:messageReactionAdd">messageReactionAdd</a></li><li><a href="Client.html#event:messageReactionRemove">messageReactionRemove</a></li><li><a href="Client.html#event:messageReactionRemoveAll">messageReactionRemoveAll</a></li><li><a href="Client.html#event:messageUpdate">messageUpdate</a></li><li><a href="Client.html#event:presenceUpdate">presenceUpdate</a></li><li><a href="Client.html#event:rawWS">rawWS</a></li><li><a href="Client.html#event:ready">ready</a></li><li><a href="Client.html#event:relationshipAdd">relationshipAdd</a></li><li><a href="Client.html#event:relationshipRemove">relationshipRemove</a></li><li><a href="Client.html#event:relationshipUpdate">relationshipUpdate</a></li><li><a href="Client.html#event:shardDisconnect">shardDisconnect</a></li><li><a href="Client.html#event:shardPreReady">shardPreReady</a></li><li><a href="Client.html#event:shardReady">shardReady</a></li><li><a href="Client.html#event:shardResume">shardResume</a></li><li><a href="Client.html#event:typingStart">typingStart</a></li><li><a href="Client.html#event:unavailableGuildCreate">unavailableGuildCreate</a></li><li><a href="Client.html#event:unknown">unknown</a></li><li><a href="Client.html#event:userUpdate">userUpdate</a></li><li><a href="Client.html#event:voiceChannelJoin">voiceChannelJoin</a></li><li><a href="Client.html#event:voiceChannelLeave">voiceChannelLeave</a></li><li><a href="Client.html#event:voiceChannelSwitch">voiceChannelSwitch</a></li><li><a href="Client.html#event:voiceStateUpdate">voiceStateUpdate</a></li><li><a href="Client.html#event:warn">warn</a></li><li><a href="Client.html#event:webhooksUpdate">webhooksUpdate</a></li><li><a href="CommandClient.html#event:callCreate">callCreate</a></li><li><a href="CommandClient.html#event:callDelete">callDelete</a></li><li><a href="CommandClient.html#event:callRing">callRing</a></li><li><a href="CommandClient.html#event:callUpdate">callUpdate</a></li><li><a href="CommandClient.html#event:channelCreate">channelCreate</a></li><li><a href="CommandClient.html#event:channelDelete">channelDelete</a></li><li><a href="CommandClient.html#event:channelPinUpdate">channelPinUpdate</a></li><li><a href="CommandClient.html#event:channelRecipientAdd">channelRecipientAdd</a></li><li><a href="CommandClient.html#event:channelRecipientRemove">channelRecipientRemove</a></li><li><a href="CommandClient.html#event:channelUpdate">channelUpdate</a></li><li><a href="CommandClient.html#event:connect">connect</a></li><li><a href="CommandClient.html#event:debug">debug</a></li><li><a href="CommandClient.html#event:disconnect">disconnect</a></li><li><a href="CommandClient.html#event:error">error</a></li><li><a href="CommandClient.html#event:friendSuggestionCreate">friendSuggestionCreate</a></li><li><a href="CommandClient.html#event:friendSuggestionDelete">friendSuggestionDelete</a></li><li><a href="CommandClient.html#event:guildAvailable">guildAvailable</a></li><li><a href="CommandClient.html#event:guildBanAdd">guildBanAdd</a></li><li><a href="CommandClient.html#event:guildBanRemove">guildBanRemove</a></li><li><a href="CommandClient.html#event:guildCreate">guildCreate</a></li><li><a href="CommandClient.html#event:guildDelete">guildDelete</a></li><li><a href="CommandClient.html#event:guildEmojisUpdate">guildEmojisUpdate</a></li><li><a href="CommandClient.html#event:guildMemberAdd">guildMemberAdd</a></li><li><a href="CommandClient.html#event:guildMemberChunk">guildMemberChunk</a></li><li><a href="CommandClient.html#event:guildMemberRemove">guildMemberRemove</a></li><li><a href="CommandClient.html#event:guildMemberUpdate">guildMemberUpdate</a></li><li><a href="CommandClient.html#event:guildRoleCreate">guildRoleCreate</a></li><li><a href="CommandClient.html#event:guildRoleDelete">guildRoleDelete</a></li><li><a href="CommandClient.html#event:guildRoleUpdate">guildRoleUpdate</a></li><li><a href="CommandClient.html#event:guildUnavailable">guildUnavailable</a></li><li><a href="CommandClient.html#event:guildUpdate">guildUpdate</a></li><li><a href="CommandClient.html#event:hello">hello</a></li><li><a href="CommandClient.html#event:messageCreate">messageCreate</a></li><li><a href="CommandClient.html#event:messageDelete">messageDelete</a></li><li><a href="CommandClient.html#event:messageDeleteBulk">messageDeleteBulk</a></li><li><a href="CommandClient.html#event:messageReactionAdd">messageReactionAdd</a></li><li><a href="CommandClient.html#event:messageReactionRemove">messageReactionRemove</a></li><li><a href="CommandClient.html#event:messageReactionRemoveAll">messageReactionRemoveAll</a></li><li><a href="CommandClient.html#event:messageUpdate">messageUpdate</a></li><li><a href="CommandClient.html#event:presenceUpdate">presenceUpdate</a></li><li><a href="CommandClient.html#event:rawWS">rawWS</a></li><li><a href="CommandClient.html#event:ready">ready</a></li><li><a href="CommandClient.html#event:relationshipAdd">relationshipAdd</a></li><li><a href="CommandClient.html#event:relationshipRemove">relationshipRemove</a></li><li><a href="CommandClient.html#event:relationshipUpdate">relationshipUpdate</a></li><li><a href="CommandClient.html#event:shardDisconnect">shardDisconnect</a></li><li><a href="CommandClient.html#event:shardPreReady">shardPreReady</a></li><li><a href="CommandClient.html#event:shardReady">shardReady</a></li><li><a href="CommandClient.html#event:shardResume">shardResume</a></li><li><a href="CommandClient.html#event:typingStart">typingStart</a></li><li><a href="CommandClient.html#event:unavailableGuildCreate">unavailableGuildCreate</a></li><li><a href="CommandClient.html#event:unknown">unknown</a></li><li><a href="CommandClient.html#event:userUpdate">userUpdate</a></li><li><a href="CommandClient.html#event:voiceChannelJoin">voiceChannelJoin</a></li><li><a href="CommandClient.html#event:voiceChannelLeave">voiceChannelLeave</a></li><li><a href="CommandClient.html#event:voiceChannelSwitch">voiceChannelSwitch</a></li><li><a href="CommandClient.html#event:voiceStateUpdate">voiceStateUpdate</a></li><li><a href="CommandClient.html#event:warn">warn</a></li><li><a href="CommandClient.html#event:webhooksUpdate">webhooksUpdate</a></li><li><a href="Shard.html#event:disconnect">disconnect</a></li><li><a href="Shard.html#event:ready">ready</a></li><li><a href="Shard.html#event:resume">resume</a></li><li><a href="SharedStream.html#event:end">end</a></li><li><a href="SharedStream.html#event:start">start</a></li><li><a href="VoiceConnection.html#event:connect">connect</a></li><li><a href="VoiceConnection.html#event:debug">debug</a></li><li><a href="VoiceConnection.html#event:disconnect">disconnect</a></li><li><a href="VoiceConnection.html#event:end">end</a></li><li><a href="VoiceConnection.html#event:error">error</a></li><li><a href="VoiceConnection.html#event:pong">pong</a></li><li><a href="VoiceConnection.html#event:ready">ready</a></li><li><a href="VoiceConnection.html#event:speakingStart">speakingStart</a></li><li><a href="VoiceConnection.html#event:speakingStop">speakingStop</a></li><li><a href="VoiceConnection.html#event:warn">warn</a></li><li><a href="VoiceDataStream.html#event:data">data</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sat May 04 2019 18:29:34 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
